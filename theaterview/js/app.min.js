!function(){"use strict";function e(){PANOLENS.Utils.loadBMFont({font:"asset/fnt/Lato-Regular-64.fnt",image:"asset/fnt/lato.png"},t)}function t(){U=new Audio("asset/audio/over.mp3"),U.stop=function(){this.currentTime=0,this.pause()},_=new Audio("asset/audio/click.mp3"),_.stop=function(){this.currentTime=0,this.pause()},W=new PANOLENS.Viewer,z=A(),F=i(),C=a(),D=S(),F.add(D),W.add(F,C),W.getContainer().style.position="fixed",W.getContainer().style.top=0}function n(){var t,n,i,a,o,s,r,l,d={};return t=["animationend","webkitAnimationEnd"],n=document.getElementById("launch-page"),i=document.getElementById("subtitle-text"),a=document.getElementById("progress-container-mask"),o=document.getElementById("progress-indicator"),s=document.getElementById("enter-button"),l=document.getElementById("progress-text"),t.forEach(function(t){i.addEventListener(t,function(){o.classList.add("ready"),e()})}),d.total=0,d.loaded=0,d.addTotal=function(e){this.total+="number"==typeof e?e:1},d.addLoaded=function(e){this.loaded+="number"==typeof e?e:1,this.checkProgress()},d.checkProgress=function(){if(this.total===this.loaded){a.classList.add("ready"),r=document.getElementsByClassName("yt-iframe");for(var e=0;e<r.length;e++)r[e].classList.add("ready")}l.textContent=Math.round(this.loaded/this.total*100)},s.addEventListener("mouseenter",function(){a.classList.contains("ready")&&U&&U.play()},!0),s.addEventListener("mouseleave",function(){a.classList.contains("ready")&&U&&U.stop()},!0),s.addEventListener("click",function(){d.total!==d.loaded||n.classList.contains("hide")||(_.play(),n.classList.add("hide"),setTimeout(function(){F&&F.tiles&&F.tiles.show()},1500))},!1),d}function i(){var e,t,n,i,a;return n=5,e=new PANOLENS.EmptyPanorama,B.addTotal(q.length),t=L(q),e.tiles=t,e.add(t),i=g("CLASSIFIED",360,28,6,t),i.position.set(-18,t.position.y+38,t.position.z),i.addEventListener("click-entity",function(){e.selection!==this&&(t.show(),D.hide(),e.selection.tweens.colorLeave.start(),e.selection=this)}),e.add(i),a=g("ALL",140,11,6,t),a.position.set(15,t.position.y+38,t.position.z),a.addEventListener("click-entity",function(){e.selection!==this&&(t.hide(),D.finished?D.show():new TWEEN.Tween(this).to({},50*(t.children.length+5)).onComplete(function(){D.finished=!0,D.animation.start(),D.show()}).start(),e.selection.tweens.colorLeave.start(),e.selection=this)}),e.add(a),e.selection=i,i.tweens.colorEnter.start(),e}function a(){var e,t,n,i,a,o,s,r,l,d,u,m,h,w,E,f,g=8;return e=new PANOLENS.EmptyPanorama,e.movieIndex=0,f="asset/textures/no-image.jpg",u=new PANOLENS.Tile(6,6),u.rotation.y=Math.PI,u.scale.multiplyScalar(.5),u.position.set(28,5,0),u.material.transparent=!0,u.tween("translateBack",u.position,{z:2}),u.tween("translateFront",u.position,{z:0}),u.addEventListener("hoverenter",function(){U.play()}),u.addEventListener("hoverleave",function(){U.stop()}),u.addEventListener("pressstart",function(){this.tweens.translateFront.stop(),this.tweens.translateBack.start()}),u.addEventListener("pressstop",function(){this.tweens.translateBack.stop(),this.tweens.translateFront.start()}),u.addEventListener("click",function(){_.stop(),_.play(),this.ripple(),M()}),m=new PANOLENS.SpriteText("back",300),m.rotation.y=Math.PI,m.scale.multiplyScalar(1.5),m.position.set(18,3.5,0),m.addEventListener("click",M),u.add(m),PANOLENS.Utils.TextureLoader.load("asset/textures/back.png",y.bind(u)),t=new PANOLENS.Tile(1.2*V/1.5,1.2*V),t.material.opacity=0,t.position.set(0,-20,-30),t.scale.multiplyScalar(.5),t.rotation.y=Math.PI,t.tween("fadeIn",t.material,{opacity:1},1e3),t.tween("translateTop",t.position,{y:10,z:0},2e3,TWEEN.Easing.Cubic.Out,1e3,null,null,function(){v(e.movie&&e.movie.trailer&&e.movie.trailer.youtube&&e.movie.trailer.youtube[0]&&e.movie.trailer.youtube[0].source)}),t.moveTop=function(){this.tweens.fadeIn.start(),this.tweens.translateTop.start()},t.reset=function(){this.ripple(),this.material.opacity=0,this.position.set(0,-20,-30)},n=new PANOLENS.Tile(4*V,2*V),n.position.set(G*Math.cos(Math.PI/2),0,-G*Math.sin(Math.PI/2)),n.material.color=new THREE.Color(0),n.material.opacity=0,n.material.blending=THREE.NoBlending,n.addEventListener("click-entity",function(e){_.stop(),_.play(),z.paused=!z.paused,z.update(),z.paused?i.tweens.fadeIn.start():i.tweens.fadeOut.start()}),i=new PANOLENS.Tile(V/2,V/2),i.material.opacity=0,i.setEntity(n),i.passThrough=!0,i.position.set(0,0,1),i.reset=function(e){e?i.tweens.fadeOut.start():i.tweens.fadeIn.start()},i.tween("fadeOut",i.material,{opacity:0}),i.tween("fadeIn",i.material,{opacity:1}),PANOLENS.Utils.TextureLoader.load("asset/textures/video-play.png",y.bind(i)),n.add(i),h=b(),h.position.set(2.5*V,0,0),h.addEventListener("click-entity",function(){e.movieIndex=e.movieIndex+1>J[e.category].results.length-1?0:e.movieIndex+1,e.updateMovie(J[e.category].results[e.movieIndex])}),h.poster.position.set(V,0,0),w=b(),w.position.set(2.5*-V,0,0),w.addEventListener("click-entity",function(){e.movieIndex=e.movieIndex-1<0?J[e.category].results.length-1:e.movieIndex-1,e.updateMovie(J[e.category].results[e.movieIndex])}),w.poster.position.set(-V,0,0),PANOLENS.Utils.TextureLoader.load("asset/textures/arrow-right.png",y.bind(h)),PANOLENS.Utils.TextureLoader.load("asset/textures/arrow-left.png",y.bind(w)),E=O(),E.position.z=-G,o=new PANOLENS.SpriteText("title",4*V*10),o.rotation.y=Math.PI,o.scale.multiplyScalar(2),o.position.set(0,38,1),s=N(10,12),s.scale.multiplyScalar(.5),s.rotation.y=Math.PI,s.position.set(-18,5,0),r=new THREE.LineSegments(new THREE.EdgesGeometry(new THREE.PlaneGeometry(10,12,1,1)),new THREE.LineBasicMaterial({color:16777215})),s.add(r),l=x(10,10,5,6),l.scale.multiplyScalar(.5),l.position.set(-26,5,0),a=new PANOLENS.SpriteText("overview",4*V*24.8),a.rotation.y=Math.PI,a.scale.multiplyScalar(.8),a.position.set(0,-35,1),d=T(),d.position.set(0,-33,1),o.add(t,u,s,l),n.add(o,a,d,h,w),e.poster=t,e.still=n,e.backdrops=E,e.pagination=d,e.placeholder=i,e.visible=!1,e.add(n,E),e.updateMovie=function(e){var n,i,r,d,u,m;this.resetMovie(),o.update({text:e.title}),a.update({text:e.overview}),l.update({text:e.vote_average.toFixed(1).toString(),voteCount:e.vote_count}),s.update(e.release_date),r=J[this.category].results,n=this.movieIndex+1>r.length-1?0:this.movieIndex+1,i=this.movieIndex-1<0?r.length-1:this.movieIndex-1,h.text.update({text:r[n].title}),w.text.update({text:r[i].title}),this.adjustComponents(),t.moveTop(),l.fadeIn(),d=e.poster_path?I(e.poster_path).replace("/w185/","/w500/"):f,u=r[n].poster_path?I(r[n].poster_path).replace("/w185/","/w500/"):f,m=r[i].poster_path?I(r[i].poster_path).replace("/w185/","/w500/"):f,PANOLENS.Utils.TextureLoader.load(d,y.bind(t)),PANOLENS.Utils.TextureLoader.load(u,y.bind(h.poster)),PANOLENS.Utils.TextureLoader.load(m,y.bind(w.poster)),c(this,{id:e.id}),p(this,{id:e.id}),this.movie=e},e.adjustComponents=function(){o.position.y=w.text.position.y=h.text.position.y=V+g,E.position.y=-5,o.position.y+=5*Math.floor(o.getLayout().height/70),h.text.position.y+=1.8*Math.floor(h.text.getLayout().height/70),w.text.position.y+=1.8*Math.floor(w.text.getLayout().height/70),E.position.y-=1.5*(Math.floor(a.getLayout().height/70)-2)},e.resetMovie=function(){z&&z.reset(),t&&t.reset(),i&&i.reset(!0),E&&E.reset(),l&&l.reset()},e.addEventListener("enter",function(){this.updateMovie(this.movie)}),e}function o(e,t){theMovieDb.genres.getMovies(t,m.bind(e),E)}function s(e,t){theMovieDb.movies.getPopular(t,m.bind(e),E)}function r(e,t){theMovieDb.movies.getUpcoming(t,m.bind(e),E)}function l(e,t){theMovieDb.movies.getNowPlaying(t,m.bind(e),E)}function d(e,t){theMovieDb.movies.getTopRated(t,m.bind(e),E)}function c(e,t){theMovieDb.movies.getImages(t,h.bind(e),E)}function p(e,t){theMovieDb.movies.getTrailers(t,w.bind(e),E)}function u(e){var t=1,n=20;if(J[e.category]&&(t=J[e.category].results.length/n+1),!(t>1))switch(e.category){case"Popular":s(e,{page:t});break;case"Now Playing":l(e,{page:t});break;case"Upcoming":r(e,{page:t});break;case"Top Rated":d(e,{page:t});break;case"Action":case"Adventure":case"Comedy":case"Fantasy":case"Science Fiction":case"TVMovie":case"Crime":o(e,{id:e.categoryId,page:t})}}function m(e){var t;e=JSON.parse(e),e&&(J[this.category]?J[this.category].results=J[this.category].results.concat(e.results):(J[this.category]=e,e.results.map(function(e){t||Q[e.id]||!e.poster_path||(t=e,Q[e.id]=e)}),e.results.splice(e.results.indexOf(t),1),e.results.unshift(t),PANOLENS.Utils.TextureLoader.load(I(t.poster_path).replace("/w185/","/w500/"),f.bind(this,B.addLoaded.bind(B)),void 0,B.addLoaded.bind(B)),B.addTotal(e.results.length),D.addMovies(e.results)),J.All.results=J.All.results.concat(e.results))}function h(e){new THREE.Vector3;this.movie.images=JSON.parse(e);for(var t=0;t<this.backdrops.children.length;t++)t<this.movie.images.backdrops.length?(this.backdrops.children[t].visible=!0,this.backdrops.children[t].src=I(this.movie.images.backdrops[t].file_path),PANOLENS.Utils.TextureLoader.load(this.backdrops.children[t].src,y.bind(this.backdrops.children[t]))):this.backdrops.children[t].visible=!1}function w(e){var t,n;t=JSON.parse(e),t&&t.youtube&&t.youtube.length>0&&(n=t.youtube[0].source),this.movie.trailer=t,this.pagination&&this.pagination.update(t&&t.youtube||[])}function E(e){}function f(e){if(arguments.length>1){var t=arguments[0];e=arguments[1],t&&t()}var n=e.image.width/e.image.height*this.geometry.parameters.height/this.geometry.parameters.width;e.wrapT=THREE.RepeatWrapping,e.repeat.set(1,n),e.offset.y=1-n,e.offset._y=e.offset.y,e.minFilter=THREE.LinearFilter,e.magFilter=THREE.LinearFilter,this.material.map=e,this.material.needsUpdate=!0}function y(e){var t;arguments.length>1&&(t=arguments[0],e=arguments[1],t()),e.minFilter=THREE.LinearFilter,e.magFilter=THREE.LinearFilter,this.material.visible=!0,this.material.map=e,this.material.needsUpdate=!0}function v(e){var t,n;e?t="http://www.youtube.com/embed/"+e+"?rel=0&autoplay=0&controls=0&showinfo=0&enablejsapi=1&iv_load_policy=3&playsinline=true":(t="asset/textures/no-video.jpg",n=!0),z.load(t),z.paused=!0}function g(e,t,n,i,a){var o,s,r,l,d,c,p,u;return r=3426654,l=500,o=new PANOLENS.Tile(n,i),o.name=e,o.tween("colorEnter",o.material.color,{r:.09375,g:39/256,b:53/256},l),o.tween("colorLeave",o.material.color,{r:52/256,g:73/256,b:94/256},l),o.tween("translateFront",o.position,{z:a.position.z}),o.tween("translateBack",o.position,{z:a.position.z-2}),o.material.color.set(r),d=new THREE.CircleGeometry(3,32,Math.PI/2,Math.PI),p=(new THREE.Matrix4).makeTranslation(-n/2,0,0),c=new THREE.CircleGeometry(3,32,-Math.PI/2,Math.PI),u=(new THREE.Matrix4).makeTranslation(n/2,0,0),o.geometry.merge(d,p),o.geometry.merge(c,u),o.addEventListener("hoverenter",function(){U.play(),F.selection!==this&&(this.tweens.colorLeave.stop(),this.tweens.colorEnter.start())}),o.addEventListener("hoverleave",function(){U.stop(),F.selection!==this&&(this.tweens.colorEnter.stop(),this.tweens.colorLeave.start())}),o.addEventListener("pressstart",function(){this.tweens.translateFront.stop(),this.tweens.translateBack.start()}),o.addEventListener("pressstop",function(){this.tweens.translateBack.stop(),this.tweens.translateFront.start()}),o.addEventListener("click-entity",function(){_.stop(),_.play()}),s=new PANOLENS.SpriteText(e,t),s.setEntity(o),s.passThrough=!0,s.position.set(1,2,1),s.scale.multiplyScalar(1.2),s.rotation.y=Math.PI,s.renderOrder=2,o.add(s),o}function L(e){var t=new THREE.Object3D,n=5,i=50;t.position.y=10,t.position.z=-G,t.isHidden=!0,t.show=function(){this.children.forEach(function(e,n){e instanceof PANOLENS.Tile&&(e.tweens.moveBack.stop(),e.tweens.fadeOut.stop(),e.shade.tweens.fadeOut.stop(),e.shade.text.tweens.fadeOut.stop(),e.tweens.moveFront.start(),e.tweens.fadeIn.start(),e.shade.tweens.fadeIn.start(),e.shade.text.tweens.fadeIn.onComplete(function(){t.isHidden=!1}).start())})},t.hide=function(){this.children.forEach(function(e,t){e instanceof PANOLENS.Tile&&(e.tweens.moveFront.stop(),e.tweens.fadeIn.stop(),e.shade.tweens.fadeIn.stop(),e.shade.text.tweens.fadeIn.stop(),e.edge.fadeInAnimation.stop(),e.tweens.moveBack.start(),e.tweens.fadeOut.start(),e.shade.tweens.fadeOut.start(),e.shade.text.tweens.fadeOut.start(),e.edge.fadeOutAnimation.start())}),t.isHidden=!0};for(var a=0;a<e.length;a++){var o,s,r,l,d,c,p,m,h,w;d=e[a].size.split("x"),c=e[a].position,o=parseFloat(d[0]),s=parseFloat(d[1]),r=V*o-2*j,l=V*s-2*j,p=new PANOLENS.Tile(r,l),p.position.set(c.x*V,c.y*V,-30),p.material.opacity=0,p.category=e[a].name,p.categoryId=e[a].id,p.scrollAnimationId=void 0,p.renderOrder=1,p.tween("moveBack",p.position,{z:-30},1e3,void 0,a*i),p.tween("moveFront",p.position,{z:0},1e3,void 0,a*i),p.tween("fadeOut",p.material,{opacity:0},1e3,void 0,a*i,null,null,R.bind(p)),p.tween("fadeIn",p.material,{opacity:1},1e3,void 0,a*i,k.bind(p),null,null),p.addEventListener("click-entity",function(){_.stop(),_.play(),C.movieData=J[this.category],C.movie=C.movieData.results[0],C.category=this.category,C.movieIndex=0,W.panorama.visible=!1,P(C)}),w=new THREE.LineSegments(new THREE.EdgesGeometry(p.geometry),new THREE.LineBasicMaterial({color:16777215})),w.material.transparent=!0,w.material.opacity=0,w.matrixAutoUpdate=!0,w.fadeOutAnimation=new TWEEN.Tween(w.material).to({opacity:0},1e3).easing(TWEEN.Easing.Exponential.Out),w.fadeInAnimation=new TWEEN.Tween(w.material).to({opacity:1},1e3).easing(TWEEN.Easing.Exponential.Out),p.edge=w,p.add(w),h=new PANOLENS.Tile(r+2,n+2),h.position.set(0,(n-l)/2,.1),h.material.opacity=0,h.material.color.set(0),h.renderOrder=2,h.setEntity(p),h.passThrough=!0,h.tween("fadeOut",h.material,{opacity:0},1e3,void 0,a*i,null,null,R.bind(h)),h.tween("fadeIn",h.material,{opacity:.7},1e3,void 0,a*i,k.bind(h),null,null),p.shade=h,p.add(h),m=new PANOLENS.SpriteText(e[a].name,500*o),m.mesh.material.uniforms.opacity.value=0,m.rotation.y=Math.PI,m.position.set(0,(s<2?2.2:1.2)*s,.2),m.renderOrder=3,m.setEntity(p),m.passThrough=!0,m.tween("fadeOut",m.mesh.material.uniforms.opacity,{value:0},300,void 0,a*i,null,null,R.bind(m)),m.tween("fadeIn",m.mesh.material.uniforms.opacity,{value:1},300,void 0,a*i,k.bind(m),null,null),h.text=m,h.add(m),p.addEventListener("hoverenter",function(e){function n(){a.y<=0?a.y=0:(a.y-=a.y>=.01?.01:a.y,i.scrollAnimationId=window.requestAnimationFrame(n))}if(this.material.map&&!t.isHidden){U.play();var i=this,a=this.material.map.offset;this.edge.fadeOutAnimation.stop(),this.edge.fadeInAnimation.start(),window.cancelAnimationFrame(this.scrollAnimationId),n()}}),p.addEventListener("hoverleave",function(e){function t(){i.y>=i._y?i.y=i._y:(i.y+=i._y-i.y<=.01?i._y-i.y:.01,n.scrollAnimationId=window.requestAnimationFrame(t))}if(this.material.map){U.stop();var n=this,i=this.material.map.offset;this.edge.fadeInAnimation.stop(),this.edge.fadeOutAnimation.start(),window.cancelAnimationFrame(this.scrollAnimationId),t()}}),u(p),t.add(p)}return t}function T(){var e,t,n=5,i=[],a=10;e=new THREE.Object3D,e.selection=void 0;for(var o=0;o<n;o++)t=new PANOLENS.Tile(1.5,1.5),t.material.color.set(16777215),t.visible=!1,t.tween("scaleup",t.scale,{x:1.4,y:1.4,z:1.4},500,TWEEN.Easing.Elastic.Out),t.tween("scaledown",t.scale,{x:1,y:1,z:1},500,TWEEN.Easing.Elastic.Out),t.tween("colorIn",t.material.color,{r:.921875,g:.9375,b:241/256}),t.tween("colorOut",t.material.color,{r:52/256,g:73/256,b:94/256}),t.addEventListener("hoverenter",function(){U.play(),e.selection!==this&&this.tweens.scaleup.start()}),t.addEventListener("hoverleave",function(){U.stop(),e.selection!==this&&this.tweens.scaledown.start()}),t.addEventListener("click",function(){_.stop(),_.play(),this.ripple(),this.source&&v(this.source),e.selection!==this&&(e.selection&&(e.selection.tweens.scaleup.stop(),e.selection.tweens.scaledown.start(),e.selection.tweens.colorIn.stop(),e.selection.tweens.colorOut.start()),e.selection=this,this.tweens.colorIn.start())}),PANOLENS.Utils.TextureLoader.load("asset/textures/circle.png",y.bind(t)),t.tweens.colorOut.start(),i.push(t),e.add(t);return e.update=function(e){this.selection&&(this.selection.tweens.scaleup.stop(),this.selection.tweens.scaledown.start(),this.selection.tweens.colorIn.stop(),this.selection.tweens.colorOut.start());for(var t=e.length<=n?e.length:n,o=0;o<n;o++)o<t?(i[o].source=e[o].source,i[o].visible=!0,i[o].position.x=o*a-(t-1)/2*a):i[o].visible=!1;this.selection=i[0],this.selection.tweens.scaleup.start(),this.selection.tweens.colorIn.start()},e}function N(e,t){var n,i,a,o,s;return n=new PANOLENS.Tile(e,t),n.material.visible=!1,i=new PANOLENS.SpriteText("23",8*V),i.setEntity(n),i.passThrough=!0,i.rotation.y=Math.PI,i.scale.multiplyScalar(1.6),i.position.set(6.5,.5*t,0),a=new PANOLENS.SpriteText("APR",8*V),a.setEntity(n),a.passThrough=!0,a.rotation.y=Math.PI,a.scale.multiplyScalar(.9),a.position.set(2.7,0,0),o=new PANOLENS.SpriteText("2016",8*V),o.setEntity(n),o.passThrough=!0,o.rotation.y=Math.PI,o.scale.multiplyScalar(.7),o.position.set(1.5,.25*-t,0),s=new PANOLENS.SpriteText("Release Date",13*V),s.rotation.y=Math.PI,s.mesh.material.uniforms.opacity.value=0,s.scale.multiplyScalar(.5),s.position.set(.2,.75*t,0),s.tween("fadeIn",s.mesh.material.uniforms.opacity,{value:1},1e3),s.tween("fadeOut",s.mesh.material.uniforms.opacity,{value:0},1e3),n.add(i,a,o,s),n.addEventListener("hoverenter",function(){U.play(),s.tweens.fadeOut.stop(),s.tweens.fadeIn.start()}),n.addEventListener("hoverleave",function(){U.stop(),s.tweens.fadeIn.stop(),s.tweens.fadeOut.start()}),n.update=function(e){var t,n,s;switch(s=e.split("-")[0],n=e.split("-")[1],t=e.split("-")[2],n){case"01":n="JAN";break;case"02":n="FEB";break;case"03":n="MAR";break;case"04":n="APR";break;case"05":n="MAY";break;case"06":n="JUN";break;case"07":n="JUL";break;case"08":n="AUG";break;case"09":n="SEP";break;case"10":n="OCT";break;case"11":n="NOV";break;case"12":n="DEC";break;default:n="N/A"}i.update({text:t}),a.update({text:n}),o.update({text:s})},n}function x(e,t,n,i){var a,o,s,r,l,d,c,p,u,m,h=[],w=[],E=150,f=1500,y=1.5;a=new THREE.Object3D,e=e||10,t=t||0,n=n||1,i=i||5,o=2*Math.PI/(e+1),s=o/(2*e),l=new THREE.MeshBasicMaterial({color:16777215,side:THREE.DoubleSide,opacity:0,transparent:!0});for(var v=0;v<e;v++)r=new THREE.RingGeometry(n,i,32,8,v*o+(2*v+1)*s+Math.PI/2,o),d=new THREE.Mesh(r,l.clone()),c=new THREE.LineSegments(new THREE.EdgesGeometry(r),new THREE.LineBasicMaterial({color:16777215})),c.material.transparent=!0,c.material.opacity=0,c.matrixAutoUpdate=!0,c.scale.multiplyScalar(y),c.fadeInAnimation=new TWEEN.Tween(c.material).to({opacity:1},f).easing(TWEEN.Easing.Quadratic.Out),c.scaleUpAnimation=new TWEEN.Tween(c.scale).to({x:1.1,y:1.1,z:1.1},f).easing(TWEEN.Easing.Elastic.Out),c.scaleDownAnimation=new TWEEN.Tween(c.scale).to({x:1,y:1,z:1},f).easing(TWEEN.Easing.Elastic.Out),h.push(c),a.add(c);return t=10==t?"1 0":t.toFixed(1),p=new PANOLENS.SpriteText(t,4*V),p.scale.multiplyScalar(1.4),p.position.set(-1.6,3.3,1),a.add(p),a.update=function(e){var a;e=e||{},e.text=e.text||"N/A",e.voteCount=e.voteCount||0,t=parseFloat(e.text),a=Math.floor(t);for(var c=0;c<=a;c++)r=new THREE.RingGeometry(n,i,32,8,c*o+(2*c+1)*s+Math.PI/2,c===a?o*(parseFloat(e.text)-a):o),d=new THREE.Mesh(r,l.clone()),d.fadeInAnimation=new TWEEN.Tween(d.material).to({opacity:1},f).easing(TWEEN.Easing.Quadratic.Out),w.push(d),h[c].add(d);p.update(e),u.update({text:e.voteCount+" votes"})},a.reset=function(){h.map(function(e,t){e.traverse(function(e){e.fadeInAnimation&&e.fadeInAnimation.stop(),e.scaleDownAnimation&&e.scaleDownAnimation.stop(),e.material&&(e.material.opacity=0),e.scale.set(y,y,y)})}),w.map(function(e){e.parent.remove(e),e.geometry.dispose(),e.material.dispose()}),w.length=0},a.fadeIn=function(){h.map(function(e,t){e.traverse(function(e){e.fadeInAnimation&&e.fadeInAnimation.delay(t*E).start(),e.scaleDownAnimation&&e.scaleDownAnimation.delay(t*E).start()})})},m=new PANOLENS.Tile(2*i,2*i),m.rotation.y=Math.PI,m.material.visible=!1,a.add(m),u=new PANOLENS.SpriteText("0 votes",13*V),u.mesh.material.uniforms.opacity.value=0,u.scale.multiplyScalar(.5),u.position.set(-1,1.5*i,0),a.message=u,a.add(u),u.tween("fadeIn",u.mesh.material.uniforms.opacity,{value:1},1e3),u.tween("fadeOut",u.mesh.material.uniforms.opacity,{value:0},1e3),m.addEventListener("hoverenter",function(){U.play(),u.tweens.fadeOut.stop(),u.tweens.fadeIn.start();for(var e=0;e<Math.ceil(t);e++)h[e].scaleDownAnimation.stop(),h[e].scaleUpAnimation.start()}),m.addEventListener("hoverleave",function(){U.stop(),u.tweens.fadeIn.stop(),u.tweens.fadeOut.start();for(var e=0;e<Math.ceil(t);e++)h[e].scaleUpAnimation.stop(),h[e].scaleDownAnimation.start()}),a}function b(){var e,t,n,i;return i=8,e=new PANOLENS.Tile(V/4,V/2),e.material.opacity=.5,e.tween("translateBack",e.position,{z:-5}),e.tween("translateFront",e.position,{z:0}),e.tween("fadeOut",e.material,{opacity:.5}),e.tween("fadeIn",e.material,{opacity:1}),e.addEventListener("click-entity",function(){_.stop(),_.play(),this.ripple()}),e.addEventListener("pressstart-entity",function(){this.tweens.translateFront.stop(),this.tweens.translateBack.start()}),e.addEventListener("pressstop-entity",function(){this.tweens.translateBack.stop(),this.tweens.translateFront.start()}),e.addEventListener("hoverenter",function(){U.play(),e.tweens.fadeIn.start(),t.tweens.fadeIn.start(),n.tweens.fadeIn.start()}),e.addEventListener("hoverleave",function(){U.stop(),e.tweens.fadeOut.start(),t.tweens.fadeOut.start(),n.tweens.fadeOut.start()}),t=new PANOLENS.Tile(4*V/3,2*V),t.material.opacity=.5,t.setEntity(e),t.tween("fadeOut",t.material,{opacity:.5}),t.tween("fadeIn",t.material,{opacity:1}),n=new PANOLENS.SpriteText("Movie",800),n.mesh.material.uniforms.opacity.value=.5,n.tween("fadeOut",n.mesh.material.uniforms.opacity,{value:.5}),n.tween("fadeIn",n.mesh.material.uniforms.opacity,{value:1}),n.position.y=V+i,n.rotation.y=Math.PI,t.add(n),e.add(t),e.text=n,e.poster=t,e}function O(){function e(){this.material.opacity=.5}function t(){this.material.opacity=1}var n,i,a,o,s,r,l,d,c=50;s=6,l=TWEEN.Easing.Cubic.Out,d=1e3,n=new THREE.Object3D,o=.05*V,r=new THREE.Vector3(0,0,G);for(var p=0;p<c;p++)i=new PANOLENS.Tile(1.78*V,V),i.material.opacity=.5,i.position.set(4.7*-V+p%s*V*1.78+(2*(p%s)+1)*o,2*-V-V*parseInt(p/s)-(2*parseInt(p/s)+1)*o,0),i.tween("moveFront",i.position,{x:0,y:-G/3,z:G/1.5},d,l,0,null,H.bind(i,r),t.bind(i)),i.tween("moveBack",i.position,{x:i.position.x,y:i.position.y,z:i.position.z},d,l,0,null,null,e.bind(i)),i.tween("rotateBack",i.rotation,{x:0,y:0,z:0},d,l),i.addEventListener("hoverenter",function(){this.edge.fadeOutAnimation.stop(),this.edge.fadeInAnimation.start(),this.material.opacity=1}),i.addEventListener("hoverleave",function(){this.edge.fadeOutAnimation.start(),this.edge.fadeInAnimation.stop(),this!==n.selection&&(this.material.opacity=.5)}),i.addEventListener("click",function(){_.stop(),_.play();return n.selection===this?void n.reset():(n.selection&&(n.selection.tweens.moveBack.start(),n.selection.tweens.rotateBack.start()),this.tweens.moveFront.start(),n.selection=this,void(this.src&&this.src.indexOf("/w185/")>=0&&(this.src=this.src.replace("/w185/","/w780/"),PANOLENS.Utils.TextureLoader.load(this.src,y.bind(this)))))}),a=new THREE.LineSegments(new THREE.EdgesGeometry(i.geometry),new THREE.LineBasicMaterial({color:16777215})),a.material.transparent=!0,a.material.opacity=0,a.matrixAutoUpdate=!0,a.fadeOutAnimation=new TWEEN.Tween(a.material).to({opacity:0},1e3).easing(TWEEN.Easing.Exponential.Out),a.fadeInAnimation=new TWEEN.Tween(a.material).to({opacity:1},1e3).easing(TWEEN.Easing.Exponential.Out),i.edge=a,i.add(a),n.add(i);return n.selection=void 0,n.reset=function(e){this.selection&&(this.selection.tweens.moveFront.stop(),e?(this.selection.tweens.moveBack.update(d),this.selection.tweens.rotateBack.update(d)):(this.selection.tweens.moveBack.start(),this.selection.tweens.rotateBack.start()),this.selection=void 0)},n}function A(){function e(e,t,n){e.contentWindow.postMessage(JSON.stringify({event:"command",func:t||"",args:n||[]}),"*")}function t(){W.mode===PANOLENS.Modes.VR&&(e(d.elementR,"mute"),e(d.elementR,"seekTo",[n.currentTime,!0]),e(d.elementL,"seekTo",[n.currentTime,!0]))}var n,i,a,o,s,r,l,d,c;return c={x:3.56,y:2},n={currentTime:0},i=new THREE.Scene,a=new THREE.Scene,o=new THREE.CSS3DRenderer,o.setSize(window.innerWidth,window.innerHeight),o.domElement.style.position="absolute",o.domElement.style.top=0,o.domElement.style.backgroundColor="#000",document.body.insertBefore(o.domElement,document.body.children[0]),s=new THREE.CSS3DStereoRenderer,s.setSize(window.innerWidth,window.innerHeight),s.domElement.style.position="absolute",s.domElement.style.top=0,s.domElement.style.backgroundColor="#000",document.body.insertBefore(s.domElement,document.body.children[0]),r=document.getElementsByClassName("yt-iframe")[0],r.paused=!0,l=new THREE.CSS3DObject(r),l.position.z=.8*-G,l.scale.x=V*c.x/window.innerWidth,l.scale.y=V*c.y/window.innerHeight,i.add(l),d=new THREE.CSS3DStereoObject(r),d.position.z=.8*-G,d.scale.x=V*c.x/window.innerWidth,d.scale.y=V*c.y/window.innerHeight,a.add(d),o.render(i,W.getCamera()),s.render(a,W.getCamera()),W.addEventListener("VR-toggle",function(i){i.mode===PANOLENS.Modes.NORMAL?(n.pause(PANOLENS.Modes.VR),document.body.children[0]===o.domElement&&document.body.insertBefore(s.domElement,o.domElement),e(l.element,"seekTo",[n.currentTime,!0])):(n.pause(PANOLENS.Modes.NORMAL),document.body.children[0]===s.domElement&&document.body.insertBefore(o.domElement,s.domElement),t()),n.update()}),W.addUpdateCallback(function(){W.mode===PANOLENS.Modes.NORMAL?o.render(i,W.getCamera()):s.render(a,W.getCamera())}),W.addEventListener("window-resize",function(){o.setSize(window.innerWidth,window.innerHeight),s.setSize(window.innerWidth,window.innerHeight)}),n.paused=!0,n.load=function(e){navigator.userAgent.match(/iPad|iPhone|iPod/i)&&(e=I(C.movie.backdrop_path).replace("/w185/","/w1280/")),C&&C.placeholder&&C.placeholder.reset(!(e.indexOf("www.youtube.com")>=0)),this.pause(),l.element.src=d.elementL.src=d.elementR.src=e},n.reset=function(){this.pause(),this.paused=!0,this.currentTime=0,l.element.src=d.elementL.src=d.elementR.src=""},n.pause=function(n){n===PANOLENS.Modes.NORMAL?e(l.element,"pauseVideo"):(e(d.elementL,"pauseVideo"),e(d.elementR,"pauseVideo"),t())},n.play=function(n){n===PANOLENS.Modes.NORMAL?e(l.element,"playVideo"):(e(d.elementL,"playVideo"),e(d.elementR,"playVideo"),t())},n.update=function(){this.paused?(e(l.element,"pauseVideo"),e(d.elementL,"pauseVideo"),e(d.elementR,"pauseVideo")):this.play(W.mode)},window.addEventListener("message",function(e){var i;i=JSON.parse(e.data),i&&i.info&&i.info.currentTime&&i.info.currentTime>n.currentTime&&(n.currentTime=i.info.currentTime),i&&"onReady"===i.event&&t()},!1),l.element.addEventListener("load",function(){l.element.contentWindow.postMessage('{"event":"listening"}',"*")}),d.elementL.addEventListener("load",function(){d.elementL.contentWindow.postMessage('{"event":"listening"}',"*"),!n.paused&&t()}),n}function S(){function e(){r.onStart(function(){i.map(function(e){new TWEEN.Tween(e.position).to({x:e.spiralPosition.x,y:e.spiralPosition.y,z:e.spiralPosition.z},2*d).easing(TWEEN.Easing.Quintic.Out).onUpdate(function(){s.set(0,e.spiralPosition.y,0),e.lookAt(s)}).start()})})}var t,n,i,a,o,s,r,l,d,c,p,u=36,m=1.7,h=1.5,w=0;return p=.5,d=2e3,c=TWEEN.Easing.Cubic.Out,i=[],s=new THREE.Vector3,t=new THREE.Object3D,t.movieIndex=0,r=new TWEEN.Tween(t),l=r,t.animation=r,t.addMovies=function(t){var s=this;w++,t=t.constructor===Array?t:[],t.map(function(t,r){t.poster_path?(o=2*Math.PI/u*(s.movieIndex%u),n=new PANOLENS.Tile(V/1.5*h,V*h),n.material.opacity=p,n.tileIndex=s.movieIndex,n.position.set((Math.random()-.5)*G*4,(Math.random()-.5)*G*2,Math.random()*G*4),n.spiralPosition=new THREE.Vector3(2*G*Math.sin(o),s.movieIndex*m,2*-G*Math.cos(o)),n.addEventListener("hoverenter",function(){this.material.opacity=1,this.title.mesh.material.uniforms.opacity.value=1}),n.addEventListener("hoverleave",function(){this.material.opacity=p,this.title.mesh.material.uniforms.opacity.value=p}),n.addEventListener("click-entity",function(){_.stop(),_.play(),C.movieData=J.All,C.movie=t,C.category="All",C.movieIndex=C.movieData.results.indexOf(t),P(C)}),n.visible=!1,n.tween("show",n.material,{opacity:p},d,c,0,k.bind(n)),n.tween("hide",n.material,{opacity:0},d,c,0,null,null,R.bind(n)),e(),PANOLENS.Utils.TextureLoader.load(I(t.poster_path),y.bind(n,B.addLoaded.bind(B)),void 0,B.addLoaded.bind(B)),a=new PANOLENS.SpriteText(t.title,600),a.rotation.y=Math.PI,a.position.y=-23,a.tween("show",a.mesh.material.uniforms.opacity,{value:p},d,c,0,k.bind(a)),a.tween("hide",a.mesh.material.uniforms.opacity,{value:0},d,c,0,null,null,R.bind(a)),n.title=a,n.add(a),i.push(n),s.add(n),s.movieIndex++):B.addLoaded()}),w===q.length&&(this.position.copy(this.getCenter()),this.position.y+=10)},t.getCenter=function(){return new THREE.Vector3(0,-this.movieIndex*m/2,0)},t.show=function(){i.map(function(e){e.tweens.hide.stop(),e.tweens.show.start(),e.title.tweens.hide.stop(),e.title.tweens.show.start()})},t.hide=function(){i.map(function(e){e.tweens.show.stop(),e.tweens.hide.start(),e.title.tweens.show.stop(),e.title.tweens.hide.start()})},t}function I(e){return theMovieDb.common.images_uri+e}function P(e){W.setPanorama(e)}function M(){W.panorama.visible=!1,P(F),C.backdrops&&C.backdrops.reset(!0),z.reset()}function k(){this.visible=!0}function R(){this.visible=!1}function H(e){this.lookAt(e)}var z,B,F,C,W,D,U,_,V=30,j=1,G=100,J={All:{results:[]}},Q={},q=[{id:28,size:"1x1",position:{x:-2.5,y:.5},name:"Action"},{id:12,size:"1x1",position:{x:-2.5,y:-.5},name:"Adventure"},{id:-1,size:"2x2",position:{x:-1,y:0},name:"Popular"},{id:35,size:"1x1",position:{x:.5,y:.5},name:"Comedy"},{id:14,size:"1x1",position:{x:.5,y:-.5},name:"Fantasy"},{id:878,size:"2x1",position:{x:2,y:.5},name:"Science Fiction"},{id:10770,size:"2x1",position:{x:2,y:-.5},name:"TVMovie"},{id:-1,size:"2x1",position:{x:-2,y:-1.5},name:"Now Playing"},{id:-1,size:"2x1",position:{x:0,y:-1.5},name:"Upcoming"},{id:-1,size:"1x1",position:{x:1.5,y:-1.5},name:"Top Rated"},{id:80,size:"1x1",position:{x:2.5,y:-1.5},name:"Crime"}];B=n()}();